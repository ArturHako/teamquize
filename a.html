<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animated Christmas Scene</title>
    <style>
        /* --- General Layout --- */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #2c1e31; /* Dark purple wall base */
            font-family: sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* --- The Main Scene Container --- */
        #scene-container {
            width: 100%;
            height: 100%;
            max-width: 1200px; /* Cap width for very wide screens */
            position: relative;
            background: radial-gradient(circle at 50% 50%, #5d3b63 0%, #2c1e31 80%);
            box-shadow: inset 0 0 100px #000;
        }

        /* SVG fills the container but preserves aspect ratio */
        svg {
            width: 100%;
            height: 100%;
            display: block;
        }

        /* --- Animations --- */

        /* 1. Light Bulb Blinking */
        @keyframes blink-1 {
            0%, 100% { fill-opacity: 1; filter: drop-shadow(0 0 5px currentColor); }
            50% { fill-opacity: 0.4; filter: drop-shadow(0 0 0 transparent); }
        }
        @keyframes blink-2 {
            0%, 100% { fill-opacity: 0.4; filter: drop-shadow(0 0 0 transparent); }
            50% { fill-opacity: 1; filter: drop-shadow(0 0 5px currentColor); }
        }
        @keyframes blink-3 {
            0%, 20% { fill-opacity: 1; }
            25%, 100% { fill-opacity: 0.3; }
        }

        /* 2. Star Glow */
        @keyframes star-pulse {
            0% { filter: drop-shadow(0 0 10px #ffd700); transform: scale(1); transform-origin: center; }
            50% { filter: drop-shadow(0 0 25px #ffea00); transform: scale(1.05); transform-origin: center; }
            100% { filter: drop-shadow(0 0 10px #ffd700); transform: scale(1); transform-origin: center; }
        }

        /* 3. Snow Falling Outside */
        @keyframes snow-fall {
            0% { transform: translateY(-10px); opacity: 0; }
            10% { opacity: 1; }
            100% { transform: translateY(200px); opacity: 0; }
        }

        /* 4. Candle/Window Flicker (subtle light change) */
        @keyframes room-flicker {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.4; }
            70% { opacity: 0.25; }
        }

        /* --- Class Assignments --- */
        .star {
            animation: star-pulse 3s infinite ease-in-out;
        }

        .light-strand {
            fill: none;
            stroke: #f0e68c;
            stroke-width: 1.5;
            opacity: 0.6;
        }

        /* Bulbs will get random animations assigned via JS or nth-child below */
        .bulb {
            transition: all 0.3s ease;
        }
        
        /* Snow particle styling */
        .snowflake {
            fill: white;
            opacity: 0.8;
        }

        .window-bg {
            fill: #1a1a40; /* Dark blue night sky */
        }
    </style>
</head>
<body>

<div id="scene-container">
    <svg viewBox="0 0 800 600" preserveAspectRatio="xMidYMax slice" xmlns="http://www.w3.org/2000/svg">
        
        <defs>
            <radialGradient id="wallGlow" cx="0.5" cy="0.5" r="0.8">
                <stop offset="0%" stop-color="#7a4b6e" />
                <stop offset="100%" stop-color="#3e2742" />
            </radialGradient>
            
            <linearGradient id="nightSky" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="#0b0b2b" />
                <stop offset="100%" stop-color="#2d2d66" />
            </linearGradient>

            <linearGradient id="treeGrad" x1="0" y1="0" x2="1" y2="0">
                <stop offset="0%" stop-color="#0f5c2e" />
                <stop offset="50%" stop-color="#1ea153" />
                <stop offset="100%" stop-color="#0f5c2e" />
            </linearGradient>

            <radialGradient id="rugGrad" cx="0.5" cy="0.5" r="0.5">
                <stop offset="0%" stop-color="#ffeebb" />
                <stop offset="100%" stop-color="#e6cca0" />
            </radialGradient>

            <clipPath id="windowClipLeft">
                <rect x="50" y="100" width="200" height="300" />
            </clipPath>
            <clipPath id="windowClipRight">
                <rect x="550" y="100" width="200" height="300" />
            </clipPath>
        </defs>

        <rect x="0" y="0" width="800" height="600" fill="url(#wallGlow)" />

        <g id="windows">
            <g clip-path="url(#windowClipLeft)">
                <rect x="50" y="100" width="200" height="300" fill="url(#nightSky)" />
                <circle cx="80" cy="150" r="1.5" fill="white" opacity="0.8" />
                <circle cx="150" cy="120" r="2" fill="white" opacity="0.6" />
                <circle cx="200" cy="200" r="1" fill="white" opacity="0.9" />
                <g id="snow-left"></g>
            </g>
            <rect x="45" y="95" width="210" height="310" fill="none" stroke="#6d4c41" stroke-width="10" />
            <line x1="150" y1="100" x2="150" y2="400" stroke="#6d4c41" stroke-width="8" />
            <line x1="50" y1="250" x2="250" y2="250" stroke="#6d4c41" stroke-width="8" />

            <g clip-path="url(#windowClipRight)">
                <rect x="550" y="100" width="200" height="300" fill="url(#nightSky)" />
                <circle cx="600" cy="130" r="2" fill="white" opacity="0.7" />
                <circle cx="700" cy="180" r="1.5" fill="white" opacity="0.9" />
                <circle cx="650" cy="250" r="1" fill="white" opacity="0.6" />
                <g id="snow-right"></g>
            </g>
            <rect x="545" y="95" width="210" height="310" fill="none" stroke="#6d4c41" stroke-width="10" />
            <line x1="650" y1="100" x2="650" y2="400" stroke="#6d4c41" stroke-width="8" />
            <line x1="550" y1="250" x2="750" y2="250" stroke="#6d4c41" stroke-width="8" />
        </g>

        <path d="M0 0 L100 0 Q120 200 80 400 L0 400 Z" fill="#d65a83" />
        <path d="M800 0 L700 0 Q680 200 720 400 L800 400 Z" fill="#d65a83" />
        <line x1="0" y1="30" x2="280" y2="30" stroke="#333" stroke-width="5" stroke-linecap="round"/>
        <line x1="520" y1="30" x2="800" y2="30" stroke="#333" stroke-width="5" stroke-linecap="round"/>

        <ellipse cx="400" cy="550" rx="300" ry="40" fill="url(#rugGrad)" />

        <g id="tree-group" transform="translate(400, 520)">
            <path d="M-180 0 L0 -120 L180 0 Q0 30 -180 0 Z" fill="url(#treeGrad)" />
            <path d="M-150 -80 L0 -200 L150 -80 Q0 -50 -150 -80 Z" fill="url(#treeGrad)" />
            <path d="M-110 -160 L0 -280 L110 -160 Q0 -130 -110 -160 Z" fill="url(#treeGrad)" />
            <path d="M-70 -240 L0 -350 L70 -240 Q0 -210 -70 -240 Z" fill="url(#treeGrad)" />

            <path d="M-120 -40 Q0 -10 120 -60" class="light-strand" />
            <path d="M-100 -120 Q0 -90 100 -140" class="light-strand" />
            <path d="M-70 -200 Q0 -170 70 -220" class="light-strand" />

            <g id="bulbs-container">
                </g>

            <circle cx="-50" cy="-30" r="10" fill="#e74c3c" /> <circle cx="60" cy="-50" r="10" fill="#f1c40f" /> <circle cx="-30" cy="-140" r="9" fill="#3498db" /> <circle cx="40" cy="-110" r="9" fill="#e67e22" /> <circle cx="0" cy="-190" r="8" fill="#9b59b6" /> <circle cx="-20" cy="-260" r="7" fill="#e74c3c" /> </g>

        <g transform="translate(400, 160)">
            <polygon points="0,-35 9,-12 33,-12 14,3 21,26 0,14 -21,26 -14,3 -33,-12 -9,-12" fill="#ffd700" class="star" />
        </g>

        <g transform="translate(400, 530)">
            <rect x="-150" y="-30" width="60" height="50" fill="#c0392b" />
            <rect x="-135" y="-30" width="10" height="50" fill="#ecf0f1" /> <rect x="-155" y="-35" width="50" height="5" fill="#ecf0f1" /> <rect x="-40" y="-20" width="80" height="40" fill="#2980b9" />
            <rect x="-10" y="-20" width="20" height="40" fill="#f1c40f" />
            
            <rect x="80" y="-40" width="50" height="60" fill="#8e44ad" />
            <rect x="100" y="-40" width="10" height="60" fill="#e056fd" />
        </g>
        
        <circle cx="100" cy="500" r="2" fill="white" opacity="0.3" class="snowflake" />
        <circle cx="700" cy="550" r="3" fill="white" opacity="0.2" class="snowflake" />

    </svg>
</div>

<script>
    // --- 1. Dynamic Snow Generation ---
    function createSnow(containerId, count) {
        const container = document.getElementById(containerId);
        for (let i = 0; i < count; i++) {
            const flake = document.createElementNS("http://www.w3.org/2000/svg", "circle");
            // Random x position (0 to 200 width of window)
            const x = Math.random() * 200;
            // Random size
            const r = Math.random() * 2 + 1;
            
            flake.setAttribute("cx", x);
            flake.setAttribute("cy", -10); // Start above
            flake.setAttribute("r", r);
            flake.setAttribute("fill", "white");
            flake.setAttribute("opacity", Math.random() * 0.5 + 0.3);
            
            // Apply animation styles dynamically to randomize timing
            const duration = Math.random() * 3 + 2; // 2 to 5 seconds
            const delay = Math.random() * 5;
            
            flake.style.animation = `snow-fall ${duration}s linear ${delay}s infinite`;
            
            container.appendChild(flake);
        }
    }

    // --- 2. Dynamic Light Bulb Generation ---
    function createBulbs() {
        const container = document.getElementById('bulbs-container');
        const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
        
        // Coordinates roughly following the string light paths
        // [x, y] relative to tree center
        const positions = [
            [-100, -30], [-50, -20], [0, -10], [50, -35], [100, -55], // Bottom strand
            [-80, -100], [-30, -90], [20, -100], [70, -130],          // Middle strand
            [-50, -180], [0, -170], [50, -200],                       // Top strand
            [-20, -270], [20, -280]                                   // Very top
        ];

        positions.forEach((pos, index) => {
            const bulb = document.createElementNS("http://www.w3.org/2000/svg", "circle");
            bulb.setAttribute("cx", pos[0]);
            bulb.setAttribute("cy", pos[1]);
            bulb.setAttribute("r", 4);
            
            // Pick a random color
            const color = colors[Math.floor(Math.random() * colors.length)];
            bulb.setAttribute("fill", color);
            bulb.classList.add("bulb");

            // Assign a random blink animation
            // We have 2 Blink types defined in CSS
            const animType = Math.random() > 0.5 ? 'blink-1' : 'blink-2';
            const duration = Math.random() * 1 + 0.5; // 0.5s to 1.5s
            
            bulb.style.animation = `${animType} ${duration}s infinite alternate`;
            
            container.appendChild(bulb);
        });
    }

    // Initialize
    window.addEventListener('load', () => {
        createSnow('snow-left', 30);
        createSnow('snow-right', 30);
        createBulbs();
    });
</script>

</body>
</html>